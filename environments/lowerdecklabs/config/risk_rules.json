{
  "description": "Risk rules (Separation of Duties policies) for lowerdecklabs Okta tenant",
  "last_synced": null,
  "version": "1.0",
  "rules": [],
  "notes": [
    "This file manages risk rules (SOD policies) for Access Certifications and Access Requests",
    "Risk rules define criteria for granted principal access that are a risk to your org",
    "To add a new risk rule, submit a PR adding the rule to the 'rules' array",
    "Run 'gh workflow run apply-risk-rules.yml -f environment=lowerdecklabs -f dry_run=false' to apply changes to Okta",
    "Run 'gh workflow run import-risk-rules.yml -f environment=lowerdecklabs' to sync from Okta",
    "",
    "Risk rule structure:",
    "  {",
    "    \"name\": \"Process and Approve Payment\",",
    "    \"description\": \"Prevent users from processing and approving payments\",",
    "    \"notes\": \"Additional context about this SOD policy\",",
    "    \"type\": \"SEPARATION_OF_DUTIES\",",
    "    \"resources\": [",
    "      {",
    "        \"resourceOrn\": \"orn:okta:idp:<org>:apps:salesforce:<appId>\"",
    "      }",
    "    ],",
    "    \"conflictCriteria\": {",
    "      \"and\": [",
    "        {",
    "          \"name\": \"list1\",",
    "          \"attribute\": \"principal.effective_grants\",",
    "          \"operation\": \"CONTAINS_ONE\",",
    "          \"value\": {",
    "            \"type\": \"ENTITLEMENTS\",",
    "            \"value\": [",
    "              {",
    "                \"id\": \"<entitlement-set-id>\",",
    "                \"values\": [",
    "                  {",
    "                    \"id\": \"<entitlement-value-id>\"",
    "                  }",
    "                ]",
    "              }",
    "            ]",
    "          }",
    "        },",
    "        {",
    "          \"name\": \"list2\",",
    "          \"attribute\": \"principal.effective_grants\",",
    "          \"operation\": \"CONTAINS_ALL\",",
    "          \"value\": {",
    "            \"type\": \"ENTITLEMENTS\",",
    "            \"value\": [",
    "              {",
    "                \"id\": \"<entitlement-set-id>\",",
    "                \"values\": [",
    "                  {",
    "                    \"id\": \"<entitlement-value-id>\"",
    "                  }",
    "                ]",
    "              }",
    "            ]",
    "          }",
    "        }",
    "      ]",
    "    }",
    "  }",
    "",
    "Operations:",
    "  - CONTAINS_ONE: Principal has at least one of the specified entitlements",
    "  - CONTAINS_ALL: Principal has all of the specified entitlements",
    "",
    "API Scopes Required:",
    "  - okta.governance.riskRule.read (for import)",
    "  - okta.governance.riskRule.manage (for apply/delete)"
  ]
}
